<!DOCTYPE html>
<!-- saved from url=(0054)https://msdn.microsoft.com/en-us/library/ms177564.aspx -->
<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="WT.seg_1" content="en-us"><link rel="canonical" href="./OUTPUT Clause (Transact-SQL)_files/OUTPUT Clause (Transact-SQL).html">
        <title>OUTPUT Clause (Transact-SQL)</title>





<meta name="DCS.dcsuri" content="/en-us/library/ms177564(d=default,l=en-us,v=sql.130).aspx">

<meta name="NormalizedUrl" content="https://msdn.microsoft.com/en-us/library/ms177564(d=default,l=en-us,v=sql.130).aspx">

<meta name="ms.normalizedurl" content="https://msdn.microsoft.com/en-us/library/ms177564(d=default,l=en-us,v=sql.130).aspx">

<meta name="DCS.appliesToProduct" content="">

<meta name="DCS.appliesToTechnology" content="">

<meta name="DCS.appliesToVersion" content="">

<meta name="ms.prod" content="sql-server-2016">

<meta name="ms.service" content="">

<meta name="ms.devlang" content="na">

<meta name="ms.topic" content="language-reference">

<meta name="VotingContextUrl" content="https://msdn.microsoft.com/en-us/library/ms177564(d=default,l=en-us,v=sql.130).aspx">

<meta name="MN" content="EE4293C3-4:44:10 AM">

<meta name="Search.ShortId" content="ms177564">

<meta name="ms.shortidmsdn" content="ms177564">

<meta name="Ms.Locale" content="en-us">

<meta name="ms.prodver" content="SQL.130">

<meta name="ms.contentlang" content="EN">

<meta name="ms.lang" content="EN">

<meta name="ms.loc" content="US">

<meta name="ms.sitever" content="2015.07.28.2">

<meta name="ms.assetid" content="41b9962c-0c71-4227-80a0-08fdc19f5fe4">

<meta name="ms.auth" content="0">








        
    <link rel="stylesheet" type="text/css" href="./OUTPUT Clause (Transact-SQL)_files/Combined.css"><script type="text/javascript" src="./OUTPUT Clause (Transact-SQL)_files/ai.0.js" async=""></script><script class="mtps-injected">try {
/**/
(window.MTPS || (window.MTPS = {})).cdnDomains || (window.MTPS.cdnDomains = { 
	"image": "https://i-msdn.sec.s-msft.com", 
	"js": "https://i2-msdn.sec.s-msft.com", 
	"css": "https://i-msdn.sec.s-msft.com", 
	"xap": "https://msdn.microsoft.com"
});
/**/
} finally { MTPS._injectNextScript_0 && MTPS._injectNextScript_0(); }</script><script class="mtps-injected" src="./OUTPUT Clause (Transact-SQL)_files/jquery-1.8.2.min.js"></script><script class="mtps-injected">try {
//
  var literalNormalizedUrl = '/en-us/library/ms177564(l=en-us,v=sql.130).aspx';
  var wt_nvr_ru = 'WT_NVR_RU';
  var wt_fpcdom = '.microsoft.com';
  var wt_domlist = 'msdn.microsoft.com';
  var wt_pathlist = '';
  var wt_paramlist = 'DCSext.mtps_devcenter';
  var wt_siteid = 'MSDN';
  var gDomain = 'm.webtrends.com';
  var gDcsId = 'dcsmgru7m99k7mqmgrhudo0k8_8c6m';
  var gFpc = 'WT_FPC';



  if (document.cookie.indexOf(gFpc + "=") == -1) {
    var wtidJs = document.createElement("script");
    wtidJs.src = "//" + gDomain + "/" + gDcsId + "/wtid.js";
    document.getElementsByTagName("head")[0].appendChild(wtidJs);
  }



  var detectedLocale = 'en-us';
  var wtsp = '_msdn_library_sqlserver_';
  var gTrackEvents = '0';
/**/
} finally { MTPS._injectNextScript_2 && MTPS._injectNextScript_2(); }</script><script class="mtps-injected">try {
//

            window.appInsightsId = '60854590-027a-4ae4-98be-2741a40f355f';
            //
} finally { MTPS._injectNextScript_3 && MTPS._injectNextScript_3(); }</script><script class="mtps-injected" src="./OUTPUT Clause (Transact-SQL)_files/Combined.js"></script><script class="mtps-injected" src="./OUTPUT Clause (Transact-SQL)_files/SearchBox.jss"></script><script class="mtps-injected" src="./OUTPUT Clause (Transact-SQL)_files/Combined(1).js"></script><script class="mtps-injected">try {
MTPS = window.MTPS || {}; MTPS.LocalizedStrings = window.MTPS.LocalizedStrings || {}; MTPS.LocalizedStrings.ExpandButtonTooltip = 'Expand'; MTPS.LocalizedStrings.CollapseButtonTooltip = 'Collapse'; MTPS.LocalizedStrings.EnhancedExpandTooltip = 'Click to expand. Double-click to expand all.'; MTPS.LocalizedStrings.EnhancedCollapseTooltip = 'Click to collapse. Double-click to collapse all.'; MTPS.LocalizedStrings.ExpandAllButtonTooltip = 'Expand All'; MTPS.LocalizedStrings.CollapseAllButtonTooltip = 'Collapse All';
} finally { MTPS._injectNextScript_7 && MTPS._injectNextScript_7(); }</script><script class="mtps-injected">try {
MTPS = window.MTPS || {}; MTPS.LocalizedStrings = window.MTPS.LocalizedStrings || {}; MTPS.LocalizedStrings.ExpandButtonTooltip = 'Expand'; MTPS.LocalizedStrings.CollapseButtonTooltip = 'Collapse'; MTPS.LocalizedStrings.EnhancedExpandTooltip = 'Click to expand. Double-click to expand all.'; MTPS.LocalizedStrings.EnhancedCollapseTooltip = 'Click to collapse. Double-click to collapse all.'; MTPS.LocalizedStrings.ExpandAllButtonTooltip = 'Expand All'; MTPS.LocalizedStrings.CollapseAllButtonTooltip = 'Collapse All';
} finally { MTPS._injectNextScript_8 && MTPS._injectNextScript_8(); }</script><script class="mtps-injected" src="./OUTPUT Clause (Transact-SQL)_files/jquery.tmpl.min.js"></script><script class="mtps-injected" src="./OUTPUT Clause (Transact-SQL)_files/Combined(2).js"></script><script src="./OUTPUT Clause (Transact-SQL)_files/broker.js"></script><script class="mtps-injected">try {
$(document).ready(function() {
        try {
            var token = $("#globalRequestVerification input[name='__RequestVerificationToken']").clone();
            $("#siteFeedbackForm").append(token);
        } catch(err) {
            
        }
    });
} finally { MTPS._injectNextScript_11 && MTPS._injectNextScript_11(); }</script><link href="./OUTPUT Clause (Transact-SQL)_files/PrintView.css" rel="stylesheet" type="text/css" media="print"><script type="text/javascript" src="./OUTPUT Clause (Transact-SQL)_files/ms.js"></script></head>
    <body class="library Chrome">
        <div id="page">
            

            
            
            
    

    
    <link type="text/css" rel="stylesheet">
    
    <input type="hidden" id="isHeaderBleeding" value="true">
    <div id="ux-header" dir="ltr" class="ltr msdn" data-device-type="desktop">
        

      <header>
        <span id="singleCol"></span>
        <span id="doubleCol"></span>
        <span id="isMobile"></span>
        <div>
          <div class="row topRow">
            <div class="top">
              <div class="left">
                <a class="msdnLogoImg" href="https://msdn.microsoft.com/en-us">
                  <div id="msft-logo" class="msft-logo"></div>
                </a>
                <div class="GrayPipe"></div>
                  <a class="DevCenterFullNameNonMegaBlade" href="https://msdn.microsoft.com/en-us">Developer Network</a>
                <a class="DevCenterFullName" href="https://msdn.microsoft.com/en-us">Developer Network</a>
                <a class="DevCenterShortName" href="https://msdn.microsoft.com/en-us">Developer</a>
              </div>
              <div class="right">
                <div id="signIn">

  <img class="profileImage" src="./OUTPUT Clause (Transact-SQL)_files/profile.jpg">



<a class="scarabLink" href="https://login.live.com/login.srf?wa=wsignin1.0&rpsnv=12&ct=1439207050&rver=6.0.5276.0&wp=MCMBI&wlcxt=MSDN%24MSDN%24MSDN&wreply=https%3a%2f%2fmsdn.microsoft.com%2fen-us%2flibrary%2fms177564.aspx&lc=1033&id=254354&mkt=en-US" title="Sign in">Sign in</a></div>




                <div class="auxNav">
                  <div>
                    <div data-fragmentname="Subscriptions" id="Fragment_Subscriptions" xmlns="http://www.w3.org/1999/xhtml">
  <a href="https://msdn.microsoft.com/subscriptions/manage/hh442900" id="Subscriptions_2153_1" xmlns="http://www.w3.org/1999/xhtml">MSDN subscriptions</a>
</div>
                    <div data-fragmentname="GetTools" id="Fragment_GetTools" xmlns="http://www.w3.org/1999/xhtml">
  <a href="http://go.microsoft.com/fwlink/?LinkId=309297&clcid=0x409&slcid=0x409&campaign=o~msft~msdn~gettools-header~dn308572" id="GetTools_2153_3" xmlns="http://www.w3.org/1999/xhtml">Get tools</a>
</div>
                  </div>
                  <div>
                    <div data-fragmentname="SocialLinks" id="Fragment_SocialLinks" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <ul class="links horizontal">
      <li>
        <a href="http://www.facebook.com/microsoftdeveloper" target="_blank" id="SocialLinks_2152_4" class="facebook" xmlns="http://www.w3.org/1999/xhtml">http://www.facebook.com/microsoftdeveloper</a>
      </li>
      <li>
        <a href="https://twitter.com/msdev" target="_blank" id="SocialLinks_2152_5" class="twitter" xmlns="http://www.w3.org/1999/xhtml">https://twitter.com/msdev</a>
      </li>
      <li>
        <a href="http://plus.google.com/111221966647232053570/" target="_blank" id="SocialLinks_2152_6" class="googlePlus" xmlns="http://www.w3.org/1999/xhtml">http://plus.google.com/111221966647232053570/</a>
      </li>
    </ul>
  </div>
</div>
                  </div>
                </div>
              </div>
            </div>

          </div>
          <div class="row middleRow">
            <div class="expandTop" style="display: none;">
              <div class="left"></div>
              <div class="right"></div>
            </div>
          </div>
        </div>
        <div id="buttomRowWrapper" class="bg_default">
          <div class="row buttomRow bg_default">
            <div class="bottom">
              <div class="left">
                <a id="grip" class="menu-icon" href="javascript:void(0)"></a>
                
                <div id="drawer">
                  <div class="toc">
                    
        <nav>
            <ul class="navL1">
                        <li class="inactive toggle">
                            <a href="javascript:void(0)" title="Technologies">Technologies</a>
                                <ul class="navL2" style="display: none;">
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/cloud-app-development-msdn" title="Cloud">Cloud</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/app-development-msdn" title="App Development">App Development</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/web-app-development-msdn" title="Web">Web</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/big-data-development-msdn" title="Data">Data</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/games-development-msdn" title="Gaming">Gaming</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive toggle">
                            <a href="javascript:void(0)" title="Downloads">Downloads</a>
                                <ul class="navL2" style="display: none;">
                                        <li class="inactive">
                                            <a href="https://www.visualstudio.com/downloads/download-visual-studio-vs" title="Visual Studio">Visual Studio</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/subscriptions" title="MSDN subscription access">MSDN subscription access</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/microsoft-sdks-msdn" title="SDKs">SDKs</a>

                                                   
                                        </li>
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="Trial software">Trial software</a>

                                                <ul class="navL3" style="display: none;">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/evalcenter" title="Free downloads">Free downloads</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/officeevaluationresources" title="Office resources">Office resources</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/sharepoint2013resources" title="SharePoint Server 2013 resources">SharePoint Server 2013 resources</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/sqlserver2014expressresources" title="SQL Server 2014 Express resources">SQL Server 2014 Express resources</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/windowsserver2012r2resources" title="Windows Server 2012 resources">Windows Server 2012 resources</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive toggle">
                            <a href="javascript:void(0)" title="Programs">Programs</a>
                                <ul class="navL2" style="display: none;">
                                        <li class="inactive">
                                            <a href="https://rewards.msdn.microsoft.com/" title="Rewards">Rewards</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://www.microsoft.com/bizspark" title="Startups">Startups</a>

                                                   
                                        </li>
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="Students">Students</a>

                                                <ul class="navL3" style="display: none;">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/imagine/imagine-home" title="Microsoft Imagine">Microsoft Imagine</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/microsoftstudentpartners" title="Microsoft Student Partners">Microsoft Student Partners</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="Architects">Architects</a>

                                                <ul class="navL3" style="display: none;">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/architects-overview-msdn" title="Overview">Overview</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/architects-case-studies-msdn" title="Case studies">Case studies</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/architects-blueprints-msdn" title="Blueprints">Blueprints</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="http://blogs.msdn.com/b/msarchitecture/" title="Blog">Blog</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="http://social.msdn.microsoft.com/forums/en-us/home?brandignore=true&sort=relevancedesc&searchterm=architecture+or+architect" title="Forums">Forums</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://events.msdn.microsoft.com/" title="Events">Events</a>

                                                   
                                        </li>
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="MSDN Subscriptions">MSDN Subscriptions</a>

                                                <ul class="navL3" style="display: none;">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/msdn-subscriptions-overview" title="Overview">Overview</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/benefits-overview" title="Benefits">Benefits</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/msdn-subscriptions-administration" title="Administrators">Administrators</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive toggle">
                            <a href="javascript:void(0)" title="Community">Community</a>
                                <ul class="navL2" style="display: none;">
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/magazine/dd767791" title="Magazine">Magazine</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://social.msdn.microsoft.com/forums/" title="Forums">Forums</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://blogs.msdn.com/b/developer-tools/" title="Blogs">Blogs</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://tech-advisors.msdn.microsoft.com/en-us" title="Tech Advisors">Tech Advisors</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://channel9.msdn.com/" title="Channel 9">Channel 9</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive current toggle">
                            <a href="javascript:void(0)" title="Documentation">Documentation</a>
                                <ul class="navL2" style="display: none;">
                                        <li class="inactive current">
                                            <a href="https://msdn.microsoft.com/library" title="APIs and reference">APIs and reference</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/developer-centers-msdn" title="Dev centers">Dev centers</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive">
                            <a href="https://code.msdn.microsoft.com/" title="Samples">Samples</a>
                        </li>
            </ul>
        </nav>

                  </div>
                </div>
              </div>
              <div class="right">
                <div data-fragmentname="SearchBox" id="Fragment_SearchBox" xmlns="http://www.w3.org/1999/xhtml">
  <div class="SearchBox">
    <form id="HeaderSearchForm" name="HeaderSearchForm" method="get">
      <button id="FakeHeaderSearchButton" value="Search" type="submit" class="header-search-button">
        <div id="search-finder" class="search-finder"></div>
      </button>
      <button id="HeaderSearchButton" style="display:none" title="Search MSDN"></button>
      <div id="searchSplitter"></div>
      <div id="searchCloseIcon" class="search-clear-x"></div>
      <div id="searchTextContainer" style="width: 0px; display: none;">
        <input id="HeaderSearchTextBox" name="query" type="text" maxlength="200" onfocus="Epx.Controls.SearchBox.watermarkFocus(event, this.title)" onblur="Epx.Controls.SearchBox.watermarkBlur(event, this.title)" autocomplete="off">
      <div id="SearchFlyoutContainer" style="display: none; text-align: left; border: 1px solid buttonshadow; position: absolute; z-index: 1000; padding: 2px; color: rgb(255, 255, 255); font-family: Arial; font-size: 16px; background-color: rgb(255, 255, 255);"><div id="SuggestionContainer"><ul style="list-style: none; padding: 4px 2px 0px 1px; cursor: pointer; margin: 1px; white-space: nowrap;"></ul></div></div></div>
    </form>
    
    
  </div>
</div>
              </div>
            </div>
          </div>
        </div>

      </header>

    <div id="overlayMaskHeader"></div></div>
    
    



<div id="skinnyRating">
    <div class="rating">
        <div id="s_ratingSection1">
            <div class="title">
                Was this page helpful?
            </div>
            <div class="description">
                Your feedback about this content is important. Let us know what you think.
            </div>
            <div class="buttons">
                <button class="button" id="s_ratingYes">Yes</button>
                <button class="button" id="s_ratingNo">No</button>
            </div>
            <input id="s_ratingValue" type="hidden" value="">
        </div>
        <div id="s_ratingSection2">
            <div id="s_skinnyRatingForm">
                <div class="title">
                    Additional feedback?
                </div>
                <textarea id="ratingText" rows="6" cols="" maxlength="1500"></textarea>
                <div class="counter right">
                    <span id="feedbackTextCounter">1500</span> characters remaining
                </div>
            </div>
            <div class="buttons left">
                <button class="button" id="s_ratingSubmit">Submit</button>
                <button class="button" id="s_ratingSkipThis">Skip this</button>
            </div>
        </div>
        <div id="s_ratingSection3" style="display: none">
            <div class="title">
                Thank you!
            </div>
            <div class="description">
                We appreciate your feedback.
            </div>
        </div>

        
        <div id="contentFeedbackQAContainer" style="display: none;"></div>
    </div>
</div>

        
    <div class="printExportMenus ltr">
        <a id="isd_printABook" href="https://msdn.microsoft.com/en-us/library/export/help/?returnUrl=%2fen-us%2flibrary%2fms177564.aspx" style="display: inline;">
            Export (<span class="count">0</span>)
        </a>
        <a id="isd_print" href="https://msdn.microsoft.com/en-us/library/ms177564(d=printer).aspx" rel="nofollow">
            Print 
        </a>
        <a id="isd_archiveControl" style="display:none;" data-include-archive="Include Previous Version" data-exclude-archive="Exclude Previous Version">
        </a>
    </div>
    

        <div class="printExportMenus ltr">
        <a id="expandCollapseAll" accesskey="e" href="javascript:void(0)" title="Expand/Collapse all sections by pressing Ctrl + Shift + e">Collapse All</a>
    </div>

    


            <div id="body">
                









    <div id="leftNav" style="width: 280px; max-width: 480px; min-height: 13799px; height: auto;">




<div id="tocnav" class="hide-archive">


            <div class="toclevel0 " data-toclevel="0" style="padding-left: 0px;">
<a class="toc_collapsed" href="https://msdn.microsoft.com/en-us/library/ms177564.aspx#"></a><a data-tochassubtree="true" href="https://msdn.microsoft.com/en-us/library/ms123401.aspx" id="ms310241_MSDN.10_en-us" mtpsaliasid="" mtpsassetid="5DDC0A78-6B2C-43E3-9C56-55F45C0DFFA5_MSDN.10_en-us" mtpsshortid="ms123401_MSDN.10_en-us" title="MSDN Library">MSDN Library</a>            </div>
            <div class="toclevel0 " data-toclevel="0" style="padding-left: 0px;">
<a class="toc_collapsed" href="https://msdn.microsoft.com/en-us/library/ms177564.aspx#"></a><a data-tochassubtree="true" href="https://msdn.microsoft.com/en-us/library/aa155072.aspx" id="aa155072_MSDN.10_en-us" mtpsaliasid="" mtpsassetid="MSDN|serverentdev|$\serverentdev.hxt@0,0_MSDN.10_en-us" mtpsshortid="aa155072_MSDN.10_en-us" title="Servers and Enterprise Development">Servers and Enterprise Development</a>            </div>
            <div class="toclevel0 " data-toclevel="0" style="padding-left: 0px;">
<a class="toc_collapsed" href="https://msdn.microsoft.com/en-us/library/ms177564.aspx#"></a><a data-tochassubtree="true" href="https://msdn.microsoft.com/en-us/library/bb545450.aspx" id="bb418431_SQL.10_en-us" mtpsaliasid="" mtpsassetid="9e4042ee-b3a7-4d92-92de-595c87e2eaf2_SQL.10_en-us" mtpsshortid="bb545450_MSDN.10_en-us" title="SQL Server">SQL Server</a>            </div>
            <div class="toclevel0 " data-toclevel="0" style="padding-left: 0px;">
<a class="toc_collapsed" href="https://msdn.microsoft.com/en-us/library/ms177564.aspx#"></a><a data-tochassubtree="true" href="https://msdn.microsoft.com/en-us/library/dn198336.aspx" id="bb418432_SQL.10_en-us" mtpsaliasid="" mtpsassetid="39da8062-36df-4ca0-b68b-49c3bcf298ca_SQL.10_en-us" mtpsshortid="dn198336_SQL.130_en-us" title="Microsoft SQL Server Language Reference">Microsoft SQL Server Language Reference</a>            </div>
            <div class="toclevel0 " data-toclevel="0" style="padding-left: 0px;">
<a class="toc_collapsed" href="https://msdn.microsoft.com/en-us/library/ms177564.aspx#"></a><a data-tochassubtree="true" href="https://msdn.microsoft.com/en-us/library/dn205322.aspx" id="dn205322_SQL.130_en-us" mtpsaliasid="" mtpsassetid="2d0dc594-1aff-1b90-1008-640b14e6df21_SQL.130_en-us" mtpsshortid="dn205322_SQL.130_en-us" title="SQL Server Language Reference">SQL Server Language Reference</a>            </div>
            <div class="toclevel0 " data-toclevel="0" style="padding-left: 0px;">
<a class="toc_collapsed" href="https://msdn.microsoft.com/en-us/library/ms177564.aspx#"></a><a data-tochassubtree="true" href="https://msdn.microsoft.com/en-us/library/bb510741.aspx" id="hh921391_SQL.130_en-us" mtpsaliasid="" mtpsassetid="dbba47d7-e08e-4435-b876-35dced1f325d_SQL.130_en-us" mtpsshortid="bb510741_SQL.130_en-us" title="Transact-SQL Reference (Database Engine)">Transact-SQL Reference (Database Engine)</a>            </div>
            <div class="toclevel1 " data-toclevel="1" data-childrenloaded="true" style="padding-left: 17px;">
<a class="toc_expanded" href="https://msdn.microsoft.com/en-us/library/ms177564.aspx#"></a><a data-tochassubtree="true" href="https://msdn.microsoft.com/en-us/library/ff848766.aspx" id="hh909906_SQL.130_en-us" mtpsaliasid="" mtpsassetid="5ff02a32-e8d3-479c-ae8b-07581e41f5f8_SQL.130_en-us" mtpsshortid="ff848766_SQL.130_en-us" title="Data Manipulation Language (DML) Statements (Transact-SQL)">Data Manipulation Language (DML) Statements (Transact-SQL)</a>            </div>
            <div class="toclevel2 " data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="https://msdn.microsoft.com/en-us/library/ms188365.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="BULK INSERT (Transact-SQL)">BULK INSERT (Transact-SQL)</a>            </div>
            <div class="toclevel2 " data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="https://msdn.microsoft.com/en-us/library/ms189835.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="DELETE (Transact-SQL)">DELETE (Transact-SQL)</a>            </div>
            <div class="toclevel2 " data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="https://msdn.microsoft.com/en-us/library/ms177634.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="FROM (Transact-SQL)">FROM (Transact-SQL)</a>            </div>
            <div class="toclevel2 " data-toclevel="2" style="padding-left: 34px;">
<a class="toc_collapsed" href="https://msdn.microsoft.com/en-us/library/ms177564.aspx#"></a><a data-tochassubtree="true" href="https://msdn.microsoft.com/en-us/library/ms187713.aspx" id="hh909831_SQL.130_en-us" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Hints (Transact-SQL)">Hints (Transact-SQL)</a>            </div>
            <div class="toclevel2 " data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="https://msdn.microsoft.com/en-us/library/ms174335.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="INSERT (Transact-SQL)">INSERT (Transact-SQL)</a>            </div>
            <div class="toclevel2 " data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="https://msdn.microsoft.com/en-us/library/bb510625.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="MERGE (Transact-SQL)">MERGE (Transact-SQL)</a>            </div>
            <div class="toclevel2 " data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="https://msdn.microsoft.com/en-us/library/ms190322.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="OPTION Clause (Transact-SQL)">OPTION Clause (Transact-SQL)</a>            </div>
            <div class="toclevel2 current " data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="./OUTPUT Clause (Transact-SQL)_files/OUTPUT Clause (Transact-SQL).html" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="OUTPUT Clause (Transact-SQL)">OUTPUT Clause (Transact-SQL)</a>            </div>
            <div class="toclevel2 " data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="https://msdn.microsoft.com/en-us/library/ms187365.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="READTEXT (Transact-SQL)">READTEXT (Transact-SQL)</a>            </div>
            <div class="toclevel2 " data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="https://msdn.microsoft.com/en-us/library/ms173545.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Search Condition (Transact-SQL)">Search Condition (Transact-SQL)</a>            </div>
            <div class="toclevel2 " data-toclevel="2" style="padding-left: 34px;">
<a class="toc_collapsed" href="https://msdn.microsoft.com/en-us/library/ms177564.aspx#"></a><a data-tochassubtree="true" href="https://msdn.microsoft.com/en-us/library/ms189499.aspx" id="hh909941_SQL.130_en-us" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="SELECT (Transact-SQL)">SELECT (Transact-SQL)</a>            </div>
            <div class="toclevel2 " data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="https://msdn.microsoft.com/en-us/library/dd776382.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Table Value Constructor (Transact-SQL)">Table Value Constructor (Transact-SQL)</a>            </div>
            <div class="toclevel2 " data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="https://msdn.microsoft.com/en-us/library/ms189463.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="TOP (Transact-SQL)">TOP (Transact-SQL)</a>            </div>
            <div class="toclevel2 " data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="https://msdn.microsoft.com/en-us/library/ms177523.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="UPDATE (Transact-SQL)">UPDATE (Transact-SQL)</a>            </div>
            <div class="toclevel2 " data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="https://msdn.microsoft.com/en-us/library/ms189466.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="UPDATETEXT (Transact-SQL)">UPDATETEXT (Transact-SQL)</a>            </div>
            <div class="toclevel2 " data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="https://msdn.microsoft.com/en-us/library/ms188047.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="WHERE (Transact-SQL)">WHERE (Transact-SQL)</a>            </div>
            <div class="toclevel2 " data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="https://msdn.microsoft.com/en-us/library/ms175972.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="WITH common_table_expression (Transact-SQL)">WITH common_table_expression (Transact-SQL)</a>            </div>
            <div class="toclevel2 " data-toclevel="2" style="padding-left: 34px;">
<span class="toc_empty"></span><a href="https://msdn.microsoft.com/en-us/library/ms186838.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="WRITETEXT (Transact-SQL)">WRITETEXT (Transact-SQL)</a>            </div>
</div>
        

        

        
        
        <div id="toc-resizable-ew" class="toc-resizable-ew"></div>
        

<a id="NavigationResize" href="javascript:void(0)" style="left: 280px; display: inline-block;">
    <img class="cl_nav_resize_open" src="./OUTPUT Clause (Transact-SQL)_files/ImageSprite.png" title="Expand" alt="Expand">
    <img class="cl_nav_resize_close" src="./OUTPUT Clause (Transact-SQL)_files/ImageSprite.png" title="Minimize" alt="Minimize" style="display: none;">
</a>



    </div>
<div id="content" class="content" style="margin-left: 280px; width: auto;">







<div xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="topic">
    <h1 class="title">OUTPUT Clause (Transact-SQL)</h1>
    
    <div class="lw_vs">
      <div id="curversion">
        <strong></strong>
      </div>
      <div id="versionclick">
        <div>
          <div>
            <a id="vsLink" href="javascript:;">
                        Other Versions
                    </a>
          </div>
          <div class="cl_vs_arrow clip10x10">
            <img class="cl_lw_vs_arrow" id="vsArrow" alt="" src="./OUTPUT Clause (Transact-SQL)_files/ImageSprite.png">
          </div>
        </div>
        <ul id="vsPanel" style="display: none;">
          <li>
            <a href="https://msdn.microsoft.com/en-us/library/ms177564(v=sql.110).aspx">SQL Server 2012</a>
          </li>
          <li>
            <a href="https://msdn.microsoft.com/en-us/library/ms177564(v=sql.105).aspx">SQL Server 2008 R2</a>
          </li>
          <li>
            <a href="https://msdn.microsoft.com/en-us/library/ms177564(v=sql.100).aspx">SQL Server 2008</a>
          </li>
          <li>
            <a href="https://msdn.microsoft.com/en-us/library/ms177564(v=sql.90).aspx">SQL Server 2005</a>
          </li>
        </ul>
      </div>
    </div>
    <div style="clear:both;"></div>
    <div id="mainSection">
      <div id="mainBody">&nbsp;<p>Applies To: SQL Server 2014, SQL Server 2016 Preview</p><div class="introduction"><p>Returns information from, or expressions based on, each row affected by an INSERT, UPDATE, DELETE, or MERGE statement. These results can be returned to the processing application for use in such things as confirmation messages, archiving, and other such application requirements. The results can also be inserted into a table or table variable. Additionally, you can capture the results of an OUTPUT clause in a nested INSERT, UPDATE, DELETE, or MERGE statement, and insert those results into a target table or view.</p><div class="alert"><table><tbody><tr><th align="left"><span><img id="s-e6f6a65cf14f462597b64ac058dbe1d0-system-media-system-caps-note" alt="System_CAPS_note" src="./OUTPUT Clause (Transact-SQL)_files/IC101471.jpeg" title="System_CAPS_note" xmlns=""></span><span class="alertTitle">Note </span></th></tr><tr><td><p>An UPDATE, INSERT, or DELETE statement that has an OUTPUT clause will return rows to the client even if the statement encounters errors and is rolled back. The result should not be used if any error occurs when you run the statement.</p></td></tr></tbody></table></div><p><span class="label">Used in: </span></p><p><a href="https://msdn.microsoft.com/en-us/library/ms189835.aspx">DELETE</a></p><p><a href="https://msdn.microsoft.com/en-us/library/ms174335.aspx">INSERT</a></p><p><a href="https://msdn.microsoft.com/en-us/library/ms177523.aspx">UPDATE</a></p><p><a href="https://msdn.microsoft.com/en-us/library/bb510625.aspx">MERGE</a></p><table><tbody><tr><td><p><strong>Applies to</strong>: SQL Server (SQL Server 2008 through <a href="http://go.microsoft.com/fwlink/p/?LinkId=299658">current version</a>), Azure SQL Database.</p></td></tr></tbody></table><p><span><img id="05b1d166-d807-482c-891f-30b3b6b58046" alt="Topic link icon" src="./OUTPUT Clause (Transact-SQL)_files/IC128933.jpeg" title="Topic link icon" xmlns=""></span>&nbsp;<a href="https://msdn.microsoft.com/en-us/library/ms177563.aspx">Transact-SQL Syntax Conventions</a></p></div><div><h2 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="Click to collapse. Double-click to collapse all." role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">Syntax</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h2><div class="sectionblock">
<div id="code-snippet-1" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_0dc1e775-3057-4386-a7ab-90281ee9462e');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_0dc1e775-3057-4386-a7ab-90281ee9462e" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>&lt;OUTPUT_CLAUSE&gt; ::=
{
&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;OUTPUT &lt;dml_select_list&gt; INTO { @table_variable | output_table }&nbsp;[ (&nbsp;column_list&nbsp;) ] ]
&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;OUTPUT &lt;dml_select_list&gt; ]
}
&lt;dml_select_list&gt; ::=
{ &lt;column_name&gt; | scalar_expression } [ [AS] column_alias_identifier ]
&nbsp;&nbsp;&nbsp;&nbsp;[ ,...n ]

&lt;column_name&gt; ::=
{ DELETED | INSERTED | from_table_name } . { * | column_name }
&nbsp;&nbsp;&nbsp;&nbsp;| $action
</pre></div>
            
        </div>
    </div>
</div>
</div></div><div><h2 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="Click to collapse. Double-click to collapse all." role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">Arguments</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h2><div class="sectionblock"><div class="section"><dl class="definitionTable"><dt><span class="literal">@</span><em>table_variable</em>&nbsp;</dt><dd><p>Specifies a <strong>table</strong> variable that the returned rows are inserted into instead of being returned to the caller. <span class="literal">@</span><em>table_variable</em> must be declared before the INSERT, UPDATE, DELETE, or MERGE statement. </p><p>If <em>column_list</em> is not specified, the <strong>table</strong> variable must have the same number of columns as the OUTPUT result set. The exceptions are identity and computed columns, which must be skipped. If <em>column_list</em> is specified, any omitted columns must either allow null values or have default values assigned to them.</p><p>For more information about <strong>table</strong> variables, see <a href="https://msdn.microsoft.com/en-us/library/ms175010.aspx">table (Transact-SQL)</a>.</p></dd><dt><em>output_table</em></dt><dd><p>Specifies a table that the returned rows are inserted into instead of being returned to the caller. <em>output_table</em> may be a temporary table.</p><p>If <em>column_list</em> is not specified, the table must have the same number of columns as the OUTPUT result set. The exceptions are identity and computed columns. These must be skipped. If <em>column_list</em> is specified, any omitted columns must either allow null values or have default values assigned to them.</p><p><em>output_table</em> cannot:</p><ul class="unordered"><li><p>Have enabled triggers defined on it.</p></li><li><p>Participate on either side of a FOREIGN KEY constraint.</p></li><li><p>Have CHECK constraints or enabled rules.</p></li></ul></dd><dt><em>column_list</em></dt><dd><p>Is an optional list of column names on the target table of the INTO clause. It is analogous to the column list allowed in the <a href="https://msdn.microsoft.com/en-us/library/ms174335.aspx">INSERT</a> statement.</p></dd><dt><em>scalar_expression </em></dt><dd><p>Is any combination of symbols and operators that evaluates to a single value. Aggregate functions are not permitted in <em>scalar_expression</em>. </p><p>Any reference to columns in the table being modified must be qualified with the INSERTED or DELETED prefix.</p></dd><dt><em>column_alias_identifier</em></dt><dd><p>Is an alternative name used to reference the column name.</p></dd><dt>DELETED </dt><dd><p>Is a column prefix that specifies the value deleted by the update or delete operation. Columns prefixed with DELETED reflect the value before the UPDATE, DELETE, or MERGE statement is completed.</p><p>DELETED cannot be used with the OUTPUT clause in the INSERT statement.</p></dd><dt>INSERTED </dt><dd><p>Is a column prefix that specifies the value added by the insert or update operation. Columns prefixed with INSERTED reflect the value after the UPDATE, INSERT, or MERGE statement is completed but before triggers are executed.</p><p>INSERTED cannot be used with the OUTPUT clause in the DELETE statement.</p></dd><dt><em>from_table_name </em></dt><dd><p>Is a column prefix that specifies a table included in the FROM clause of a DELETE, UPDATE, or MERGE statement that is used to specify the rows to update or delete.</p><p>If the table being modified is also specified in the FROM clause, any reference to columns in that table must be qualified with the INSERTED or DELETED prefix.</p></dd><dt>*</dt><dd><p>Specifies that all columns affected by the delete, insert, or update action will be returned in the order in which they exist in the table. </p><p>For example, <span class="code">OUTPUT DELETED.*</span> in the following DELETE statement returns all columns deleted from the <span class="code">ShoppingCartItem</span> table: </p>
<div id="code-snippet-2" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_16644113-6155-4e4e-b3d1-bd2792a56ef0');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_16644113-6155-4e4e-b3d1-bd2792a56ef0" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>DELETE Sales.ShoppingCartItem
    OUTPUT DELETED.*;
</pre></div>
            
        </div>
    </div>
</div>
</dd><dt><em>column_name</em></dt><dd><p>Is an explicit column reference. Any reference to the table being modified must be correctly qualified by either the INSERTED or the DELETED prefix as appropriate, for example: INSERTED<strong>.</strong><em>column_name</em>.</p></dd><dt>$action</dt><dd><p>Is available only for the MERGE statement. Specifies a column of type <strong>nvarchar(10)</strong> in the OUTPUT clause in a MERGE statement that returns one of three values for each row: 'INSERT', 'UPDATE', or 'DELETE', according to the action that was performed on that row.</p></dd></dl></div></div></div><div><h2 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="Click to collapse. Double-click to collapse all." role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">Remarks</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h2><div class="sectionblock"><div class="section"><p>The OUTPUT &lt;dml_select_list&gt; clause and the OUTPUT &lt;dml_select_list&gt; INTO { <strong>@</strong><em>table_variable</em> | <em>output_table</em> } clause can be defined in a single INSERT, UPDATE, DELETE, or MERGE statement.</p><div class="alert"><table><tbody><tr><th align="left"><span><img id="s-e6f6a65cf14f462597b64ac058dbe1d0-system-media-system-caps-note" alt="System_CAPS_note" src="./OUTPUT Clause (Transact-SQL)_files/IC101471.jpeg" title="System_CAPS_note" xmlns=""></span><span class="alertTitle">Note </span></th></tr><tr><td><p>Unless specified otherwise, references to the OUTPUT clause refer to both the OUTPUT clause and the OUTPUT INTO clause. </p></td></tr></tbody></table></div><p>The OUTPUT clause may be useful to retrieve the value of identity or computed columns after an INSERT or UPDATE operation. </p><p>When a computed column is included in the &lt;dml_select_list&gt;, the corresponding column in the output table or table variable is not a computed column. The values in the new column are the values that were computed at the time the statement was executed.</p><p>There is no guarantee that the order in which the changes are applied to the table and the order in which the rows are inserted into the output table or table variable will correspond.</p><p>If parameters or variables are modified as part of an UPDATE statement, the OUTPUT clause always returns the value of the parameter or variable as it was before the statement executed instead of the modified value.</p><p>You can use OUTPUT with an UPDATE or DELETE statement positioned on a cursor that uses WHERE CURRENT OF syntax.</p><p>The OUTPUT clause is not supported in the following statements:</p><ul class="unordered"><li><p>DML statements that reference local partitioned views, distributed partitioned views, or remote tables. </p></li><li><p>INSERT statements that contain an EXECUTE statement.</p></li><li><p>Full-text predicates are not allowed in the OUTPUT clause when the database compatibility level is set to 100.</p></li><li><p>The OUTPUT INTO clause cannot be used to insert into a view, or rowset function.</p></li><li><p>A user-defined function cannot be created if it contains an OUTPUT INTO clause that has a table as its target.</p></li></ul><p>To prevent nondeterministic behavior, the OUTPUT clause cannot contain the following references:</p><ul class="unordered"><li><p>Subqueries or user-defined functions that perform user or system data access, or are assumed to perform such access. User-defined functions are assumed to perform data access if they are not schema-bound. </p></li><li><p>A column from a view or inline table-valued function when that column is defined by one of the following methods:</p><ul class="unordered"><li><p>A subquery.</p></li><li><p>A user-defined function that performs user or system data access, or is assumed to perform such access.</p></li><li><p>A computed column that contains a user-defined function that performs user or system data access in its definition. </p></li></ul><p>When SQL Server detects such a&nbsp;column in the OUTPUT clause, error 4186 is raised. For more information, see&nbsp;<a href="https://msdn.microsoft.com/en-us/library/cc645595.aspx">MSSQLSERVER_4186</a>.</p></li></ul></div><div><h3 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="Click to collapse. Double-click to collapse all." role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">Inserting Data Returned From an OUTPUT Clause Into a Table</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h3><div class="sectionblock"><div class="section"><p>When you are capturing the results of an OUTPUT clause in a nested INSERT, UPDATE, DELETE, or MERGE statement and inserting those results into a target table, keep the following information in mind:</p><ul class="unordered"><li><p>The whole operation is atomic. Either both the INSERT statement and the nested DML statement that contains the OUTPUT clause execute, or the whole statement fails.</p></li><li><p>The following restrictions apply to the target of the outer INSERT statement:</p><ul class="unordered"><li><p>The target cannot be a remote table, view, or common table expression.</p></li><li><p>The target cannot have a FOREIGN KEY constraint, or be referenced by a FOREIGN KEY constraint.</p></li><li><p>Triggers cannot be defined on the target.</p></li><li><p>The target cannot participate in merge replication or updatable subscriptions for transactional replication.</p></li></ul></li><li><p>The following restrictions apply to the nested DML statement: </p><ul class="unordered"><li><p>The target cannot be a remote table or partitioned view.</p></li><li><p>The source itself cannot contain a &lt;dml_table_source&gt; clause.</p></li></ul></li><li><p>The OUTPUT INTO clause is not supported in INSERT statements that contain a &lt;dml_table_source&gt; clause. </p></li><li><p>@@ROWCOUNT returns the rows inserted only by the outer INSERT statement.</p></li><li><p>@@IDENTITY, SCOPE_IDENTITY, and IDENT_CURRENT return identity values generated only by the nested DML statement, and not those generated by the outer INSERT statement.</p></li><li><p>Query notifications treat the statement as a single entity, and the type of any message that is created will be the type of the nested DML, even if the significant change is from the outer INSERT statement itself.</p></li><li><p>In the &lt;dml_table_source&gt; clause, the SELECT and WHERE clauses cannot include subqueries, aggregate functions, ranking functions, full-text predicates, user-defined functions that perform data access, or the TEXTPTR function.</p></li></ul></div></div></div><div><h3 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="Click to collapse. Double-click to collapse all." role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">Triggers</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h3><div class="sectionblock"><div class="section"><p>Columns returned from OUTPUT reflect the data as it is after the INSERT, UPDATE, or DELETE statement has completed but before triggers are executed. </p><p>For INSTEAD OF triggers, the returned results are generated as if the INSERT, UPDATE, or DELETE had actually occurred, even if no modifications take place as the result of the trigger operation. If a statement that includes an OUTPUT clause is used inside the body of a trigger, table aliases must be used to reference the trigger <span class="literal">inserted</span> and <span class="literal">deleted</span> tables to avoid duplicating column references with the INSERTED and DELETED tables associated with OUTPUT.</p><p>If the OUTPUT clause is specified without also specifying the INTO keyword, the target of the DML operation cannot have any enabled trigger defined on it for the given DML action. For example, if the OUTPUT clause is defined in an UPDATE statement, the target table cannot have any enabled UPDATE triggers.</p><p>If the <span class="literal">sp_configure</span> option <span class="literal">disallow results from triggers</span> is set, an OUTPUT clause without an INTO clause causes the statement to fail when it is invoked from within a trigger.</p></div></div></div><div><h3 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="Click to collapse. Double-click to collapse all." role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">Data Types</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h3><div class="sectionblock"><div class="section"><p>The OUTPUT clause supports the large object data types: <strong>nvarchar(max)</strong>, <strong>varchar(max)</strong>, <strong>varbinary(max)</strong>,<strong> text</strong>, <strong>ntext</strong>, <strong>image</strong>, and <strong>xml</strong>. When you use the .WRITE clause in the UPDATE statement to modify an <strong>nvarchar(max)</strong>, <strong>varchar(max)</strong>, or <strong>varbinary(max)</strong> column, the full before and after images of the values are returned if they are referenced. The TEXTPTR( ) function cannot appear as part of an expression on a <strong>text</strong>, <strong>ntext</strong>, or <strong>image</strong> column in the OUTPUT clause.</p></div></div></div><div><h3 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="Click to collapse. Double-click to collapse all." role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">Queues</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h3><div class="sectionblock"><div class="section"><p>You can use OUTPUT in applications that use tables as queues, or to hold intermediate result sets. That is, the application is constantly adding or removing rows from the table. The following example uses the OUTPUT clause in a DELETE statement to return the deleted row to the calling application.</p>
<div id="code-snippet-3" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_228c2e88-6410-4b81-aedf-776cf86da64c');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_228c2e88-6410-4b81-aedf-776cf86da64c" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>USE AdventureWorks2012;
GO
DELETE TOP(1) dbo.DatabaseLog WITH (READPAST)
OUTPUT deleted.*
WHERE DatabaseLogID = 7;
GO


</pre></div>
            
        </div>
    </div>
</div>
<p>This example removes a row from a table used as a queue and returns the deleted values to the processing application in a single action. Other semantics may also be implemented, such as using a table to implement a stack. However, SQL Server does not guarantee the order in which rows are processed and returned by DML statements using the OUTPUT clause. It is up to the application to include an appropriate WHERE clause that can guarantee the desired semantics, or understand that when multiple rows may qualify for the DML operation, there is no guaranteed order. The following example uses a subquery and assumes uniqueness is a characteristic of the <span class="code">DatabaseLogID</span> column in order to implement the desired ordering semantics.</p>
<div id="code-snippet-4" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_6227175e-b609-4f5f-9835-e8bea7f9eaa1');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_6227175e-b609-4f5f-9835-e8bea7f9eaa1" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>USE tempdb;
GO
CREATE TABLE dbo.table1
(
    id INT,
    employee VARCHAR(32)
);
GO

INSERT INTO dbo.table1 VALUES 
      (1, 'Fred')
     ,(2, 'Tom')
     ,(3, 'Sally')
     ,(4, 'Alice');
GO

DECLARE @MyTableVar TABLE
(
    id INT,
    employee VARCHAR(32)
);

PRINT 'table1, before delete' 
SELECT * FROM dbo.table1;

DELETE FROM dbo.table1
OUTPUT DELETED.* INTO @MyTableVar
WHERE id = 4 OR id = 2;

PRINT 'table1, after delete'
SELECT * FROM dbo.table1;

PRINT '@MyTableVar, after delete'
SELECT * FROM @MyTableVar;

DROP TABLE dbo.table1;

--Results
--table1, before delete
--id          employee
------------- ------------------------------
--1           Fred
--2           Tom
--3           Sally
--4           Alice
--
--table1, after delete
--id          employee
------------- ------------------------------
--1           Fred
--3           Sally
--@MyTableVar, after delete
--id          employee
------------- ------------------------------
--2           Tom
--4           Alice

</pre></div>
            
        </div>
    </div>
</div>
<div class="alert"><table><tbody><tr><th align="left"><span><img id="s-e6f6a65cf14f462597b64ac058dbe1d0-system-media-system-caps-note" alt="System_CAPS_note" src="./OUTPUT Clause (Transact-SQL)_files/IC101471.jpeg" title="System_CAPS_note" xmlns=""></span><span class="alertTitle">Note </span></th></tr><tr><td><p>Use the READPAST table hint in UPDATE and DELETE statements if your scenario allows for multiple applications to perform a destructive read from one table. This prevents locking issues that can come up if another application is already reading the first qualifying record in the table.</p></td></tr></tbody></table></div></div></div></div></div></div><div><h2 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="Click to collapse. Double-click to collapse all." role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">Permissions</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h2><div class="sectionblock"><div class="section"><p>SELECT permissions are required on any columns retrieved through &lt;dml_select_list&gt; or used in &lt;scalar_expression&gt;.</p><p>INSERT permissions are required on any tables specified in &lt;output_table&gt;.</p></div></div></div><div><h2 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="Click to collapse. Double-click to collapse all." role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">Examples</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h2><div class="sectionblock"><div class="section"></div><div><h3 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="Click to collapse. Double-click to collapse all." role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">A. Using OUTPUT INTO with a simple INSERT statement</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h3><div class="sectionblock"><div class="section"><p>The following example inserts a row into the <span class="code">ScrapReason</span> table and uses the <span class="code">OUTPUT</span> clause to return the results of the statement to the <span class="code">@MyTableVar</span>&nbsp;<span class="code">table</span> variable. Because the <span class="code">ScrapReasonID</span> column is defined with an IDENTITY property, a value is not specified in the <span class="code">INSERT</span> statement for that column. However, note that the value generated by the Database Engine for that column is returned in the <span class="code">OUTPUT</span> clause in the column <span class="code">inserted.ScrapReasonID</span>.</p>
<div id="code-snippet-5" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_f0786afa-0913-4a1f-aa57-ab6534071e25');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_f0786afa-0913-4a1f-aa57-ab6534071e25" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>USE AdventureWorks2012;
GO
DECLARE @MyTableVar table( NewScrapReasonID smallint,
                           Name varchar(50),
                           ModifiedDate datetime);
INSERT Production.ScrapReason
    OUTPUT INSERTED.ScrapReasonID, INSERTED.Name, INSERTED.ModifiedDate
        INTO @MyTableVar
VALUES (N'Operator error', GETDATE());

--Display the result set of the table variable.
SELECT NewScrapReasonID, Name, ModifiedDate FROM @MyTableVar;
--Display the result set of the table.
SELECT ScrapReasonID, Name, ModifiedDate 
FROM Production.ScrapReason;
GO

</pre></div>
            
        </div>
    </div>
</div>
</div></div></div><div><h3 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="Click to collapse. Double-click to collapse all." role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">B. Using OUTPUT with a DELETE statement</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h3><div class="sectionblock"><div class="section"><p>The following example deletes all rows in the <span class="code">ShoppingCartItem</span> table. The clause <span class="code">OUTPUT deleted.*</span> specifies that the results of the <span class="code">DELETE</span> statement, that is all columns in the deleted rows, be returned to the calling application. The <span class="code">SELECT</span> statement that follows verifies the results of the delete operation on the <span class="code">ShoppingCartItem</span> table.</p>
<div id="code-snippet-6" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_df5dabb3-0ce3-4eeb-b113-aefe024053f2');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_df5dabb3-0ce3-4eeb-b113-aefe024053f2" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>USE AdventureWorks2012;
GO
DELETE Sales.ShoppingCartItem
OUTPUT DELETED.* 
WHERE ShoppingCartID = 20621;

--Verify the rows in the table matching the WHERE clause have been deleted.
SELECT COUNT(*) AS [Rows in Table] FROM Sales.ShoppingCartItem WHERE ShoppingCartID = 20621;
GO

</pre></div>
            
        </div>
    </div>
</div>
</div></div></div><div><h3 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="Click to collapse. Double-click to collapse all." role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">C. Using OUTPUT INTO with an UPDATE statement</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h3><div class="sectionblock"><div class="section"><p>The following example updates the <span class="code">VacationHours</span> column in the <span class="code">Employee</span> table by 25 percent for the first 10 rows. The <span class="code">OUTPUT</span> clause returns the <span class="code">VacationHours</span> value that exists before applying the <span class="code">UPDATE</span> statement in the column <span class="code">deleted.VacationHours</span>, and the updated value in the column <span class="code">inserted.VacationHours</span> to the <span class="code">@MyTableVar</span>&nbsp;<span class="code">table</span> variable. </p><p>Two <span class="code">SELECT</span> statements follow that return the values in <span class="code">@MyTableVar</span> and the results of the update operation in the <span class="code">Employee</span> table. </p>
<div id="code-snippet-7" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_90921098-6cb3-4a30-b2d6-7c1ec816934e');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_90921098-6cb3-4a30-b2d6-7c1ec816934e" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>USE AdventureWorks2012;
GO

DECLARE @MyTableVar table(
    EmpID int NOT NULL,
    OldVacationHours int,
    NewVacationHours int,
    ModifiedDate datetime);

UPDATE TOP (10) HumanResources.Employee
SET VacationHours = VacationHours * 1.25,
    ModifiedDate = GETDATE() 
OUTPUT inserted.BusinessEntityID,
       deleted.VacationHours,
       inserted.VacationHours,
       inserted.ModifiedDate
INTO @MyTableVar;

--Display the result set of the table variable.
SELECT EmpID, OldVacationHours, NewVacationHours, ModifiedDate
FROM @MyTableVar;
GO
--Display the result set of the table.
SELECT TOP (10) BusinessEntityID, VacationHours, ModifiedDate
FROM HumanResources.Employee;
GO

</pre></div>
            
        </div>
    </div>
</div>
</div></div></div><div><h3 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="Click to collapse. Double-click to collapse all." role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">D. Using OUTPUT INTO to return an expression</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h3><div class="sectionblock"><div class="section"><p>The following example builds on example C by defining an expression in the <span class="code">OUTPUT</span> clause as the difference between the updated <span class="code">VacationHours</span> value and the <span class="code">VacationHours</span> value before the update was applied. The value of this expression is returned to the <span class="code">@MyTableVar</span>&nbsp;<span class="code">table</span> variable in the column <span class="code">VacationHoursDifference</span>.</p>
<div id="code-snippet-8" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_392416a2-3106-4e22-81dd-435d8a84a994');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_392416a2-3106-4e22-81dd-435d8a84a994" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>USE AdventureWorks2012;
GO
DECLARE @MyTableVar table(
    EmpID int NOT NULL,
    OldVacationHours int,
    NewVacationHours int,
    VacationHoursDifference int,
    ModifiedDate datetime);

UPDATE TOP (10) HumanResources.Employee
SET VacationHours = VacationHours * 1.25,
    ModifiedDate = GETDATE()
OUTPUT inserted.BusinessEntityID,
       deleted.VacationHours,
       inserted.VacationHours,
       inserted.VacationHours - deleted.VacationHours,
       inserted.ModifiedDate
INTO @MyTableVar;

--Display the result set of the table variable.
SELECT EmpID, OldVacationHours, NewVacationHours, 
    VacationHoursDifference, ModifiedDate
FROM @MyTableVar;
GO
SELECT TOP (10) BusinessEntityID, VacationHours, ModifiedDate
FROM HumanResources.Employee;
GO


</pre></div>
            
        </div>
    </div>
</div>
</div></div></div><div><h3 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="Click to collapse. Double-click to collapse all." role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">E. Using OUTPUT INTO with from_table_name in an UPDATE statement</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h3><div class="sectionblock"><div class="section"><p>The following example updates the <span class="code">ScrapReasonID </span>column in the <span class="code">WorkOrder</span> table for all work orders with a specified <span class="code">ProductID</span> and <span class="code">ScrapReasonID</span>. The <span class="code">OUTPUT INTO</span> clause returns values from the table being updated (<span class="code">WorkOrder</span>) and also from the <span class="code">Product</span> table. The <span class="code">Product</span> table is used in the <span class="code">FROM</span> clause to specify the rows to update. Because the <span class="code">WorkOrder</span> table has an <span class="code">AFTER UPDATE</span> trigger defined on it, the <span class="code">INTO</span> keyword is required.</p>
<div id="code-snippet-9" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_c2c93ad4-2e31-4088-b999-e1c34c3486b2');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_c2c93ad4-2e31-4088-b999-e1c34c3486b2" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>USE AdventureWorks2012;
GO
DECLARE @MyTestVar table (
    OldScrapReasonID int NOT NULL, 
    NewScrapReasonID int NOT NULL, 
    WorkOrderID int NOT NULL,
    ProductID int NOT NULL,
    ProductName nvarchar(50)NOT NULL);

UPDATE Production.WorkOrder
SET ScrapReasonID = 4
OUTPUT deleted.ScrapReasonID,
       inserted.ScrapReasonID, 
       inserted.WorkOrderID,
       inserted.ProductID,
       p.Name
    INTO @MyTestVar
FROM Production.WorkOrder AS wo
    INNER JOIN Production.Product AS p 
    ON wo.ProductID = p.ProductID 
    AND wo.ScrapReasonID= 16
    AND p.ProductID = 733;

SELECT OldScrapReasonID, NewScrapReasonID, WorkOrderID, 
    ProductID, ProductName 
FROM @MyTestVar;
GO

</pre></div>
            
        </div>
    </div>
</div>
</div></div></div><div><h3 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="Click to collapse. Double-click to collapse all." role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">F. Using OUTPUT INTO with from_table_name in a DELETE statement</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h3><div class="sectionblock"><div class="section"><p>The following example deletes rows in the <span class="code">ProductProductPhoto</span> table based on search criteria defined in the <span class="code">FROM</span> clause of <span class="code">DELETE</span> statement. The <span class="code">OUTPUT</span> clause returns columns from the table being deleted (<span class="code">deleted.ProductID</span>, <span class="code">deleted.ProductPhotoID</span>) and columns from the <span class="code">Product</span> table. This table is used in the <span class="code">FROM</span> clause to specify the rows to delete.</p>
<div id="code-snippet-10" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_71264d82-72e2-4095-a7fb-c63315de9374');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_71264d82-72e2-4095-a7fb-c63315de9374" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>USE AdventureWorks2012;
GO
DECLARE @MyTableVar table (
    ProductID int NOT NULL, 
    ProductName nvarchar(50)NOT NULL,
    ProductModelID int NOT NULL, 
    PhotoID int NOT NULL);

DELETE Production.ProductProductPhoto
OUTPUT DELETED.ProductID,
       p.Name,
       p.ProductModelID,
       DELETED.ProductPhotoID
    INTO @MyTableVar
FROM Production.ProductProductPhoto AS ph
JOIN Production.Product as p 
    ON ph.ProductID = p.ProductID 
    WHERE p.ProductModelID BETWEEN 120 and 130;

--Display the results of the table variable.
SELECT ProductID, ProductName, ProductModelID, PhotoID 
FROM @MyTableVar
ORDER BY ProductModelID;
GO

</pre></div>
            
        </div>
    </div>
</div>
</div></div></div><div><h3 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="Click to collapse. Double-click to collapse all." role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">G. Using OUTPUT INTO with a large object data type</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h3><div class="sectionblock"><div class="section"><p>The following example updates a partial value in <span class="code">DocumentSummary</span>, an <span class="code">nvarchar(max)</span> column in the <span class="code">Production.Document</span> table, by using the <span class="code">.WRITE</span> clause. The word <span class="code">components</span> is replaced by the word <span class="code">features</span> by specifying the replacement word, the beginning location (offset) of the word to be replaced in the existing data, and the number of characters to be replaced (length). The example uses the <span class="code">OUTPUT</span> clause to return the before and after images of the <span class="code">DocumentSummary </span>column to the <span class="code">@MyTableVar</span>&nbsp;<span class="code">table</span> variable. Note that the full before and after images of the <span class="code">DocumentSummary</span> column are returned.</p>
<div id="code-snippet-11" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_97da6f6c-5603-4692-af21-f5b7a92877e2');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_97da6f6c-5603-4692-af21-f5b7a92877e2" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>USE AdventureWorks2012;
GO
DECLARE @MyTableVar table (
    SummaryBefore nvarchar(max),
    SummaryAfter nvarchar(max));

UPDATE Production.Document
SET DocumentSummary .WRITE (N'features',28,10)
OUTPUT deleted.DocumentSummary, 
       inserted.DocumentSummary 
    INTO @MyTableVar
WHERE Title = N'Front Reflector Bracket Installation';

SELECT SummaryBefore, SummaryAfter 
FROM @MyTableVar;
GO

</pre></div>
            
        </div>
    </div>
</div>
</div></div></div><div><h3 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="Click to collapse. Double-click to collapse all." role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">H. Using OUTPUT in an INSTEAD OF trigger</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h3><div class="sectionblock"><div class="section"><p>The following example uses the <span class="code">OUTPUT</span> clause in a trigger to return the results of the trigger operation. First, a view is created on the <span class="code">ScrapReason</span> table, and then an <span class="code">INSTEAD OF INSERT</span> trigger is defined on the view that lets only the <span class="code">Name</span> column of the base table to be modified by the user. Because the column <span class="code">ScrapReasonID</span> is an <span class="code">IDENTITY</span> column in the base table, the trigger ignores the user-supplied value. This allows the Database Engine to automatically generate the correct value. Also, the value supplied by the user for <span class="code">ModifiedDate</span> is ignored and is set to the current date. The <span class="code">OUTPUT</span> clause returns the values actually inserted into the <span class="code">ScrapReason</span> table.</p>
<div id="code-snippet-12" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_4d3187ae-8e15-4564-82b6-4d0d6a9c6fea');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_4d3187ae-8e15-4564-82b6-4d0d6a9c6fea" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>USE AdventureWorks2012;
GO
IF OBJECT_ID('dbo.vw_ScrapReason','V') IS NOT NULL
    DROP VIEW dbo.vw_ScrapReason;
GO
CREATE VIEW dbo.vw_ScrapReason
AS (SELECT ScrapReasonID, Name, ModifiedDate
    FROM Production.ScrapReason);
GO
CREATE TRIGGER dbo.io_ScrapReason 
    ON dbo.vw_ScrapReason
INSTEAD OF INSERT
AS
BEGIN
--ScrapReasonID is not specified in the list of columns to be inserted 
--because it is an IDENTITY column.
    INSERT INTO Production.ScrapReason (Name, ModifiedDate)
        OUTPUT INSERTED.ScrapReasonID, INSERTED.Name, 
               INSERTED.ModifiedDate
    SELECT Name, getdate()
    FROM inserted;
END
GO
INSERT vw_ScrapReason (ScrapReasonID, Name, ModifiedDate)
VALUES (99, N'My scrap reason','20030404');
GO


</pre></div>
            
        </div>
    </div>
</div>
<p>Here is the result set generated on April 12, 2004 ('<span class="code">2004-04-12'</span>). Notice that the <span class="code">ScrapReasonIDActual</span> and <span class="code">ModifiedDate</span> columns reflect the values generated by the trigger operation instead of the values provided in the <span class="code">INSERT</span> statement.</p><p><span class="code">ScrapReasonID&nbsp;&nbsp;Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ModifiedDate</span></p><p><span class="code">-------------&nbsp;&nbsp;----------------&nbsp;-----------------------</span></p><p><span class="code">17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;My scrap reason&nbsp;&nbsp;2004-04-12 16:23:33.050</span></p></div></div></div><div><h3 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="Click to collapse. Double-click to collapse all." role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">I. Using OUTPUT INTO with identity and computed columns</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h3><div class="sectionblock"><div class="section"><p>The following example creates the <span class="code">EmployeeSales</span> table and then inserts several rows into it using an <span class="code">INSERT</span> statement with a <span class="code">SELECT</span> statement to retrieve data from source tables. The <span class="code">EmployeeSales</span> table contains an identity column (<span class="code">EmployeeID</span>) and a computed column (<span class="code">ProjectedSales</span>). </p>
<div id="code-snippet-13" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_e6da59f5-b74a-4b09-aa28-a0838c5d55b7');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_e6da59f5-b74a-4b09-aa28-a0838c5d55b7" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>USE AdventureWorks2012 ;
GO
IF OBJECT_ID ('dbo.EmployeeSales', 'U') IS NOT NULL
    DROP TABLE dbo.EmployeeSales;
GO
CREATE TABLE dbo.EmployeeSales
( EmployeeID   int IDENTITY (1,5)NOT NULL,
  LastName     nvarchar(20) NOT NULL,
  FirstName    nvarchar(20) NOT NULL,
  CurrentSales money NOT NULL,
  ProjectedSales AS CurrentSales * 1.10 
);
GO
DECLARE @MyTableVar table(
  EmployeeID   int NOT NULL,
  LastName     nvarchar(20) NOT NULL,
  FirstName    nvarchar(20) NOT NULL,
  CurrentSales money NOT NULL,
  ProjectedSales money NOT NULL
  );

INSERT INTO dbo.EmployeeSales (LastName, FirstName, CurrentSales)
  OUTPUT INSERTED.LastName, 
         INSERTED.FirstName, 
         INSERTED.CurrentSales
  INTO @MyTableVar
    SELECT c.LastName, c.FirstName, sp.SalesYTD
    FROM Sales.SalesPerson AS sp
    INNER JOIN Person.Person AS c
        ON sp.BusinessEntityID = c.BusinessEntityID
    WHERE sp.BusinessEntityID LIKE '2%'
    ORDER BY c.LastName, c.FirstName;

SELECT EmployeeID, LastName, FirstName, CurrentSales, ProjectedSales
FROM @MyTableVar;
GO
SELECT EmployeeID, LastName, FirstName, CurrentSales, ProjectedSales
FROM dbo.EmployeeSales;
GO

</pre></div>
            
        </div>
    </div>
</div>
</div></div></div><div><h3 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="Click to collapse. Double-click to collapse all." role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">J. Using OUTPUT and OUTPUT INTO in a single statement</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h3><div class="sectionblock"><div class="section"><p>The following example deletes rows in the <span class="code">ProductProductPhoto</span> table based on search criteria defined in the <span class="code">FROM</span> clause of <span class="code">DELETE</span> statement. The <span class="code">OUTPUT INTO</span> clause returns columns from the table being deleted (<span class="code">deleted.ProductID</span>, <span class="code">deleted.ProductPhotoID</span>) and columns from the <span class="code">Product</span> table to the <span class="code">@MyTableVar</span>&nbsp;<span class="code">table</span> variable. The <span class="code">Product</span> table is used in the <span class="code">FROM</span> clause to specify the rows to delete. The <span class="code">OUTPUT</span> clause returns the <span class="code">deleted.ProductID</span>, <span class="code">deleted.ProductPhotoID</span> columns and the date and time the row was deleted from the <span class="code">ProductProductPhoto</span> table to the calling application.</p>
<div id="code-snippet-14" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_508f2727-e291-4297-aa10-9fd6c4f6c5a9');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_508f2727-e291-4297-aa10-9fd6c4f6c5a9" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>USE AdventureWorks2012;
GO
DECLARE @MyTableVar table (
    ProductID int NOT NULL, 
    ProductName nvarchar(50)NOT NULL,
    ProductModelID int NOT NULL, 
    PhotoID int NOT NULL);

DELETE Production.ProductProductPhoto
OUTPUT DELETED.ProductID,
       p.Name,
       p.ProductModelID,
       DELETED.ProductPhotoID
    INTO @MyTableVar
OUTPUT DELETED.ProductID, DELETED.ProductPhotoID, GETDATE() AS DeletedDate 
FROM Production.ProductProductPhoto AS ph
JOIN Production.Product as p 
    ON ph.ProductID = p.ProductID 
WHERE p.ProductID BETWEEN 800 and 810;

--Display the results of the table variable.
SELECT ProductID, ProductName, PhotoID, ProductModelID 
FROM @MyTableVar;
GO


</pre></div>
            
        </div>
    </div>
</div>
</div></div></div><div><h3 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="Click to collapse. Double-click to collapse all." role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">K. Inserting data returned from an OUTPUT clause</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h3><div class="sectionblock"><div class="section"><p>The following example captures data returned from the <span class="code">OUTPUT</span> clause of a <span class="code">MERGE</span> statement, and inserts that data into another table. The <span class="code">MERGE</span> statement updates the <span class="code">Quantity</span> column of the <span class="code">ProductInventory</span> table daily, based on orders that are processed in the <span class="code">SalesOrderDetail</span> table. It also deletes rows for products whose inventories drop to <span class="code">0</span> or below. The example captures the rows that are deleted and inserts them into another table, <span class="code">ZeroInventory</span>, which tracks products with no inventory.</p>
<div id="code-snippet-15" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_aa85fe88-7607-4437-9951-28648634c333');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_aa85fe88-7607-4437-9951-28648634c333" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>USE AdventureWorks2012;
GO
IF OBJECT_ID(N'Production.ZeroInventory', N'U') IS NOT NULL
    DROP TABLE Production.ZeroInventory;
GO
--Create ZeroInventory table.
CREATE TABLE Production.ZeroInventory (DeletedProductID int, RemovedOnDate DateTime);
GO

INSERT INTO Production.ZeroInventory (DeletedProductID, RemovedOnDate)
SELECT ProductID, GETDATE()
FROM
(   MERGE Production.ProductInventory AS pi
    USING (SELECT ProductID, SUM(OrderQty) FROM Sales.SalesOrderDetail AS sod
           JOIN Sales.SalesOrderHeader AS soh
           ON sod.SalesOrderID = soh.SalesOrderID
           AND soh.OrderDate = '20070401'
           GROUP BY ProductID) AS src (ProductID, OrderQty)
    ON (pi.ProductID = src.ProductID)
    WHEN MATCHED AND pi.Quantity - src.OrderQty &lt;= 0
        THEN DELETE
    WHEN MATCHED
        THEN UPDATE SET pi.Quantity = pi.Quantity - src.OrderQty
    OUTPUT $action, deleted.ProductID) AS Changes (Action, ProductID)
WHERE Action = 'DELETE';
IF @@ROWCOUNT = 0
PRINT 'Warning: No rows were inserted';
GO
SELECT DeletedProductID, RemovedOnDate FROM Production.ZeroInventory; 


</pre></div>
            
        </div>
    </div>
</div>
</div></div></div></div></div><div><h2 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="Click to collapse. Double-click to collapse all." role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">See Also</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h2><div class="sectionblock"><p><a href="https://msdn.microsoft.com/en-us/library/ms189835.aspx">DELETE (Transact-SQL)</a><br><a href="https://msdn.microsoft.com/en-us/library/ms174335.aspx">INSERT (Transact-SQL)</a><br><a href="https://msdn.microsoft.com/en-us/library/ms177523.aspx">UPDATE (Transact-SQL)</a><br><a href="https://msdn.microsoft.com/en-us/library/ms175010.aspx">table (Transact-SQL)</a><br><a href="https://msdn.microsoft.com/en-us/library/ms189799.aspx">CREATE TRIGGER (Transact-SQL)</a><br><a href="https://msdn.microsoft.com/en-us/library/ms188787.aspx">sp_configure (Transact-SQL)</a><br></p></div></div></div>
    </div>
  </div>
</div>


    



<script id="CommentTemplate" type="text/x-jquery-tmpl">
    <div class="communityContentAnnotation">
        <a name="${Index}"></a>
        <h3>
            ${Title}
        </h3>
        <div class="communityContentAnnotationBody">
            {{html Body}}
        </div>
        <div class="communityContentAnnotationInfo">
            <div class="communityContentAnnotationAvatarContainer">
                <a href="${UserAvatar.Href}" title="${UserAvatar.ToolTip}" class="communityContentAnnotationAvatar"><img src="${UserAvatar.ImageUrl}" alt="${UserAvatar.ImageAltText}" width="34" height="34" /></a>
            </div>
            <div class="communityContentAnnotationUserDateContainer">
                <div class="communityContentAnnotationUserContainer">
                    <a href="${UserAvatar.Href}">
                        ${User}
                    </a>
                </div>
                <div class="communityContentAnnotationDateContainer">
                    <span>${Date}</span>
                    
                    {{if EditLink}}
                        <span>
                            <a href="${EditLink.Href}" title="${EditLink.ToolTip}" class="communityContentCommentEditLink">${EditLink.Title}</a>
                        </span>
                    {{/if}}

                    {{if DeleteLink}}
                        <span>
                            <a href="${DeleteLink.Href}" title="${DeleteLink.ToolTip}" class="communityContentDeleteLink">${DeleteLink.Title}</a>
                        </span>
                    {{/if}}
                </div>
            </div>
        </div>
    </div>
</script>

<div class="communityContentContainer">
    <div id="CommunityContentHeader" class="communityContentHeader">
        <div class="communityContentHeaderTitleContainer">
            <h2>Community Additions</h2>
                <a class="communityContentAddLink" href="https://msdn.microsoft.com/en-us/library/community/add/ms177564.aspx">
                    <span class="communityContentAddButton" title="Add">
                        ADD
                    </span>
                </a>
        </div>
        <div style="clear: both;"></div>
    </div>
    
    <div id="CommunityComments" data-url="/en-us/library/community/comments/ms177564.aspx"></div>
</div>




<div class="libraryMemberFilter">
    <div class="filterContainer">
        <span>Show:</span>
        <label>
            <input type="checkbox" class="libraryFilterInherited" checked="checked" value="Inherit">Inherited
        </label>
        <label>
            <input type="checkbox" class="libraryFilterProtected" checked="checked" value="Protected">Protected
        </label>
    </div>
</div>
    
<input type="hidden" id="libraryMemberFilterEmptyWarning" value="There are no members available with your current filter settings.">


 
</div>


            </div>
            <div class="clear"></div>

            
    
<input name="__RequestVerificationToken" type="hidden" value="4waLGP3hHosDBTHdiilfidKDcfXpSqloWUVAY_uiX41vHuSpZpIbokQtTU75Yqzsjno6CZ1javEJd5bTZZ1Ousfd5aA1">
<input id="ratingSubmitUrl" type="hidden" value="https://msdn.microsoft.com/en-us/library/feedback/add/ms177564.aspx">
<input id="isTopicRated" type="hidden" value="false">


    

    
    <link type="text/css" rel="stylesheet">
    
    <div id="ux-footer" class="" style="" dir="ltr">
            
            <div id="footerSock" class="librarySock both">
                <div id="footerSockInner">
                        <a name="feedback"></a>

<div class="rating">
    <div id="ratingSection1">
        <div class="title">
            Was this page helpful?
        </div>
        <div class="description">
            Your feedback about this content is important.<br>Let us know what you think.
        </div>
        <div class="buttons">
            <button class="button" id="ratingYes">Yes</button>
            <button class="button" id="ratingNo">No</button>
        </div>
        <input id="ratingValue" type="hidden" value="">
    </div>
    <div id="ratingSection2">
        <div class="title">
            Additional feedback?
        </div>
        <textarea id="ratingText" rows="6" cols="" maxlength="1500"></textarea>
        <div class="counter right">
            <span id="feedbackTextCounter">1500</span> characters remaining
        </div>
        <div class="buttons left">
            <button class="button" id="ratingSubmit">Submit</button>
            <button class="button" id="ratingSkipThis">Skip this</button>
        </div>
    </div>
    <div id="ratingSection3">
        <div class="title">
            Thank you!
        </div>
        <div class="description">
            We appreciate your feedback.
        </div>
    </div>
    
    
    <div id="contentFeedbackQAContainer" style="display: none;"></div>
</div>
    
                    <div class="userVoice">
    <div class="title">
        Have a suggestion to improve MSDN Library?
    </div>
        <div class="description">
            Visit our UserVoice Page to submit and vote on ideas!
        </div>
    <div class="buttons">
        <a class="button" id="userVoiceButton" href="http://feedback.msdn.com/forums/257782-msdn-feature-suggestions/category/83975" target="_blank">Make a suggestion</a>
    </div>
</div>  
                    <div class="clear"></div>
                </div>
            </div>

        <footer class="top">
            <div data-fragmentname="LeftLinks" id="Fragment_LeftLinks" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">Dev centers</div>
    <ul class="links">
      <li>
        <a href="https://dev.windows.com/" id="LeftLinks_2148_1" class="windowsBlue" xmlns="http://www.w3.org/1999/xhtml">Windows</a>
      </li>
      <li>
        <a href="http://dev.office.com/" id="LeftLinks_2148_3" class="office" xmlns="http://www.w3.org/1999/xhtml">Office</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/vstudio" id="LeftLinks_2148_4" class="visualStudio" xmlns="http://www.w3.org/1999/xhtml">Visual Studio</a>
      </li>
      <li>
        <a href="http://azure.microsoft.com/en-us/documentation/" target="_blank" id="LeftLinks_2148_12" xmlns="http://www.w3.org/1999/xhtml">Microsoft Azure</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/aa937802" id="LeftLinks_2148_5" xmlns="http://www.w3.org/1999/xhtml">More...</a>
      </li>
    </ul>
  </div>
</div>    
            <div id="rightLinks">
                <div data-fragmentname="CenterLinks1" id="Fragment_CenterLinks1" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">Learning resources</div>
    <ul class="links">
      <li>
        <a href="http://www.microsoftvirtualacademy.com/" id="CenterLinks1_2151_4" xmlns="http://www.w3.org/1999/xhtml">Microsoft Virtual Academy</a>
      </li>
      <li>
        <a href="http://channel9.msdn.com/" id="CenterLinks1_2151_5" xmlns="http://www.w3.org/1999/xhtml">Channel 9</a>
      </li>
      <li>
        <a href="http://www.interoperabilitybridges.com/" id="CenterLinks1_2151_6" xmlns="http://www.w3.org/1999/xhtml">Interoperability Bridges</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/magazine/" id="CenterLinks1_2151_7" xmlns="http://www.w3.org/1999/xhtml">MSDN Magazine</a>
      </li>
    </ul>
  </div>
</div>
                <div data-fragmentname="CenterLinks2" id="Fragment_CenterLinks2" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">Community</div>
    <ul class="links">
      <li>
        <a href="https://social.msdn.microsoft.com/forums/en-us/home" id="CenterLinks2_2151_8" xmlns="http://www.w3.org/1999/xhtml">Forums</a>
      </li>
      <li>
        <a href="http://blogs.msdn.com/b/developer-tools/" id="CenterLinks2_2151_9" xmlns="http://www.w3.org/1999/xhtml">Blogs</a>
      </li>
      <li>
        <a href="http://www.codeplex.com/" id="CenterLinks2_2151_10" xmlns="http://www.w3.org/1999/xhtml">Codeplex</a>
      </li>
    </ul>
  </div>
</div>
                <div data-fragmentname="CenterLinks3" id="Fragment_CenterLinks3" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">Support</div>
    <ul class="links">
      <li>
        <a href="https://msdn.microsoft.com/hh361695" id="CenterLinks3_2151_11" xmlns="http://www.w3.org/1999/xhtml">Self support</a>
      </li>
    </ul>
  </div>
</div>
                <div data-fragmentname="CenterLinks4" id="Fragment_CenterLinks4" xmlns="http://www.w3.org/1999/xhtml" class="nth-child-4n">
  
  <div class="linkList">
    <div class="linkListTitle">Programs</div>
    <ul class="links">
      <li>
        <a href="https://www.microsoft.com/bizspark/" id="CenterLinks4_2151_13" xmlns="http://www.w3.org/1999/xhtml">BizSpark (for startups)</a>
      </li>
      <li>
        <a href="https://www.dreamspark.com/" id="CenterLinks4_2151_14" xmlns="http://www.w3.org/1999/xhtml">DreamSpark</a>
      </li>
      <li>
        <a href="http://www.imaginecup.com/" id="CenterLinks4_2151_17" xmlns="http://www.w3.org/1999/xhtml">Imagine Cup</a>
      </li>
    </ul>
  </div>
</div>                
            </div>
        </footer>
    
        <footer class="bottom">
            <span class="localeContainer">
                
    <form class="selectLocale" id="selectLocaleForm" action="https://msdn.microsoft.com/en-us/selectlocale-dmc">
        <input type="hidden" name="fromPage" value="https%3a%2f%2fmsdn.microsoft.com%2fen-us%2flibrary%2fms177564.aspx">
        <a href="https://msdn.microsoft.com/en-us/library/ms177564.aspx#" onclick="$(&#39;#selectLocaleForm&#39;).submit();return false;" title="Change your language">United States (English)</a>
    </form>


            </span>
        
            <div data-fragmentname="BottomLinks" id="Fragment_BottomLinks" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <ul class="links horizontal">
      <li>
        <a href="https://msdn.microsoft.com/newsletter.aspx" id="BottomLinks_2148_7" xmlns="http://www.w3.org/1999/xhtml">Newsletter</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/dn529288" id="BottomLinks_2148_8" xmlns="http://www.w3.org/1999/xhtml">Privacy &amp; cookies</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/cc300389" id="BottomLinks_2148_9" xmlns="http://www.w3.org/1999/xhtml">Terms of use</a>
      </li>
      <li>
        <a href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" id="BottomLinks_2148_10" xmlns="http://www.w3.org/1999/xhtml">Trademarks</a>
      </li>
    </ul>
  </div>
</div>    
            <span class="logoLegal">
                <span class="logo"></span>
                <span class="copyright">© 2015 Microsoft</span>
            </span>
        </footer>
    </div>
    


            <div class="footerPrintView">
                <div class="footerCopyrightPrintView">© 2015 Microsoft</div>
            </div>

            
            
    
    
    <input id="tocPaddingPerLevel" type="hidden" value="17">



            <input id="MtpsDevice" type="hidden" value="Default">


<!--[CDATA[ Third party scripts and code linked to or referenced from this website are licensed to you by the parties that own such code, not by Microsoft.  See ASP.NET Ajax CDN Terms of Use – http://www.asp.net/ajaxlibrary/CDN.ashx. ]]-->

            
            
            
            
            






<noscript>&lt;div&gt;&lt;img alt="DCSIMG" id="Img1" width="1" height="1" src="https://m.webtrends.com/dcsmgru7m99k7mqmgrhudo0k8_8c6m/njs.gif?dcsuri=/nojavascript&amp;amp;WT.js=No" /&gt;&lt;/div&gt;</noscript>








<div id="globalRequestVerification">
    <input name="__RequestVerificationToken" type="hidden" value="202vLJt9Xx01aWbnb8H2Izo6cT8ek-CLkNL_t_fSDRMqjbKZp86_L1JQx5mtFV79rewhlOsZUGfQJH_zkEWkW54-dQ81">
</div>


        </div>

        
        
        
        
    <script type="text/javascript" class="mtps-injected">
/*<![CDATA[*/
(function(window,document){"use strict";function preload(scripts){for(var result=[],script,e,i=0;i<scripts.length;i++)script=scripts[i],script.hasOwnProperty("url")&&(e=document.createElement("script"),e.src=script.url,script.throwaway=e),result.push(script);return result}function inject(scripts,index){var script,elem;if(index>=scripts.length){delete mtps.injectScripts;return}script=scripts[index];elem=document.createElement("script");elem.className="mtps-injected";elem.async=!1;var isLoaded=!1,timeoutId=0,injectNextFnName="",injectNext=elem.onerror=function(){isLoaded||(isLoaded=!0,inject(scripts,index+1),window.clearTimeout(timeoutId),elem.onload=elem.onerror=elem.onreadystatechange=null,injectNextFnName&&delete mtps[injectNextFnName],elem.removeEventListener&&elem.removeEventListener("load",injectNext,!1))};elem.addEventListener?elem.addEventListener("load",injectNext,!1):elem.readyState==="uninitialized"?elem.onreadystatechange=function(){(this.readyState==="loaded"||this.readyState==="complete")&&injectNext()}:elem.onload=injectNext;script.hasOwnProperty("url")?(timeoutId=window.setTimeout(injectNext,12e4),elem.src=script.url):(injectNextFnName="_injectNextScript_"+index,mtps[injectNextFnName]=injectNext,timeoutId=window.setTimeout(injectNext,2e3),elem.text="try {\n"+script.txt+"\n} finally { MTPS."+injectNextFnName+" && MTPS."+injectNextFnName+"(); }");parent.appendChild(elem)}var mtps=window.MTPS||(window.MTPS={}),parent=document.getElementsByTagName("head")[0];mtps.injectScripts=function(scripts){inject(preload(scripts),0)}})(window,document);
MTPS.injectScripts([
	{ txt: "/**/\r\n(window.MTPS || (window.MTPS = {})).cdnDomains || (window.MTPS.cdnDomains = { \r\n\t\"image\": \"https://i-msdn.sec.s-msft.com\", \r\n\t\"js\": \"https://i2-msdn.sec.s-msft.com\", \r\n\t\"css\": \"https://i-msdn.sec.s-msft.com\", \r\n\t\"xap\": \"https://msdn.microsoft.com\"\r\n});\r\n/**/" },
	{ url: "https://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.2.min.js" },
	{ txt: "//\n  var literalNormalizedUrl = \u0027/en-us/library/ms177564(l=en-us,v=sql.130).aspx\u0027;\n  var wt_nvr_ru = \u0027WT_NVR_RU\u0027;\n  var wt_fpcdom = \u0027.microsoft.com\u0027;\n  var wt_domlist = \u0027msdn.microsoft.com\u0027;\n  var wt_pathlist = \u0027\u0027;\n  var wt_paramlist = \u0027DCSext.mtps_devcenter\u0027;\n  var wt_siteid = \u0027MSDN\u0027;\n  var gDomain = \u0027m.webtrends.com\u0027;\n  var gDcsId = \u0027dcsmgru7m99k7mqmgrhudo0k8_8c6m\u0027;\n  var gFpc = \u0027WT_FPC\u0027;\n\n\n\n  if (document.cookie.indexOf(gFpc + \"=\") == -1) {\n    var wtidJs = document.createElement(\"script\");\n    wtidJs.src = \"//\" + gDomain + \"/\" + gDcsId + \"/wtid.js\";\n    document.getElementsByTagName(\"head\")[0].appendChild(wtidJs);\n  }\n\n\n\n  var detectedLocale = \u0027en-us\u0027;\n  var wtsp = \u0027_msdn_library_sqlserver_\u0027;\n  var gTrackEvents = \u00270\u0027;\n/**/" },
	{ txt: "//\n\n            window.appInsightsId = \u002760854590-027a-4ae4-98be-2741a40f355f\u0027;\n            //" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:Utilities,1:Layout,2:Header,3:SkinnyRating,1:Rating,2:Footer,0:Topic,4:webtrendsscript,5:WEDCS,0:AppInsightsPerf,6:Toc,1:SearchBox;/Areas/Epx/Content/Scripts:0,/Areas/Epx/Themes/Base/Content:1,/Areas/Centers/Themes/StandardDevCenter/Content:2,/Areas/Library/Themes/Msdn/Content:3,/Areas/Global/Content/Webtrends/resources:4,/Areas/Library/Themes/Base/Content:5,/Areas/Library/Content:6\u0026amp;hashKey=B8008380DCD78AB06124122C695B6E0D\u0026amp;v=49CA1727C04DD1563A68B0D566A40E16" },
	{ url: "https://i1.services.social.microsoft.com/search/Widgets/SearchBox.jss?boxid=HeaderSearchTextBox\u0026btnid=HeaderSearchButton\u0026brand=Msdn\u0026loc=en-us\u0026focusOnInit=false\u0026emptyWatermark=true\u0026searchButtonTooltip=Search MSDN" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:PrintExportButton,1:NavigationResize;/Areas/Library/Themes/Base/Content:0,/Areas/Library/Content:1\u0026amp;hashKey=86914F35EE0A9731DDD02541EA123CEF\u0026amp;v=49CA1727C04DD1563A68B0D566A40E16" },
	{ txt: "MTPS = window.MTPS || {}; MTPS.LocalizedStrings = window.MTPS.LocalizedStrings || {}; MTPS.LocalizedStrings.ExpandButtonTooltip = \u0027Expand\u0027; MTPS.LocalizedStrings.CollapseButtonTooltip = \u0027Collapse\u0027; MTPS.LocalizedStrings.EnhancedExpandTooltip = \u0027Click to expand. Double-click to expand all.\u0027; MTPS.LocalizedStrings.EnhancedCollapseTooltip = \u0027Click to collapse. Double-click to collapse all.\u0027; MTPS.LocalizedStrings.ExpandAllButtonTooltip = \u0027Expand All\u0027; MTPS.LocalizedStrings.CollapseAllButtonTooltip = \u0027Collapse All\u0027;" },
	{ txt: "MTPS = window.MTPS || {}; MTPS.LocalizedStrings = window.MTPS.LocalizedStrings || {}; MTPS.LocalizedStrings.ExpandButtonTooltip = \u0027Expand\u0027; MTPS.LocalizedStrings.CollapseButtonTooltip = \u0027Collapse\u0027; MTPS.LocalizedStrings.EnhancedExpandTooltip = \u0027Click to expand. Double-click to expand all.\u0027; MTPS.LocalizedStrings.EnhancedCollapseTooltip = \u0027Click to collapse. Double-click to collapse all.\u0027; MTPS.LocalizedStrings.ExpandAllButtonTooltip = \u0027Expand All\u0027; MTPS.LocalizedStrings.CollapseAllButtonTooltip = \u0027Collapse All\u0027;" },
	{ url: "https://ajax.aspnetcdn.com/ajax/jquery.templates/beta1/jquery.tmpl.min.js" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:CommunityContent,0:LibraryMemberFilter,1:Toc_Fixed,1:CodeSnippet,1:TopicNotInScope,1:CollapsibleArea,1:VersionSelector,1:SurveyBroker;/Areas/Library/Content:0,/Areas/Epx/Content/Scripts:1\u0026amp;hashKey=EB298C838117D9E7008C7CC11E7732E3\u0026amp;v=49CA1727C04DD1563A68B0D566A40E16" },
	{ txt: "$(document).ready(function() {\n        try {\n            var token = $(\"#globalRequestVerification input[name=\u0027__RequestVerificationToken\u0027]\").clone();\n            $(\"#siteFeedbackForm\").append(token);\n        } catch(err) {\n            \n        }\n    });" }
]);

/*]]>*/
</script>
<script src="./OUTPUT Clause (Transact-SQL)_files/broker-config.js"></script><div id="overlayMask"></div></body></html>